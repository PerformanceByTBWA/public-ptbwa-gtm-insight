___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "public-ptbwa-gtm-insight",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "Ptbwa Insight Pixel",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "pixelId",
    "displayName": "Pixel ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "alwaysInSummary": true
  },
  {
    "type": "TEXT",
    "name": "eventType",
    "displayName": "",
    "simpleValueType": true,
    "alwaysInSummary": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const getUrl = require('getUrl');
const getReferrerUrl = require('getReferrerUrl');
const getCookieValues = require('getCookieValues');
const setCookie = require('setCookie');
const generateRandom = require('generateRandom');
const getTimestampMillis = require('getTimestampMillis');
const sendPixel = require('sendPixel');
const encodeUriComponent = require('encodeUriComponent');
const JSON = require('JSON');

const COOKIE_NAME = '_insight_uid';
const GA_COOKIE = '_ga';
const PIXEL_ENDPOINT = 'https://track.ptbwa.com/v1/';


function createUuid() {
  const hex = '0123456789abcdef';
  const sections = [8, 4, 4, 4, 12];
  let uuid = '';
  for (let i = 0; i < sections.length; i++) {
    if (i > 0) uuid += '-';
    for (let j = 0; j < sections[i]; j++) {
      // generateRandom(min, max) returns a float between min (inclusive) and max (exclusive)
      const index = generateRandom(0, 16); 
      uuid += hex.charAt(index | 0); // bitwise OR 0 is allowed, acts like Math.floor
    }
  }
  return uuid;
}



function getOrCreateUid(cookieName) {
  let uid = getCookieValues(cookieName)[0];
  if (!uid) uid = createUuid();
  setCookie(cookieName, uid, {
    'max-age': 60 * 60 * 24 * 30, // 30일
    'secure': true
  });
  return uid;
}


function serialize(params) {
  var query = '';
  for (var key in params) {
    if (params.hasOwnProperty(key)) {
      if (query.length > 0) query += '&';
      query += key + '=' + encodeUriComponent(params[key] || '');
    }
  }
  return query;
}


(function () {
  const userId = getOrCreateUid(COOKIE_NAME);
  const gaId = getCookieValues(GA_COOKIE)[0] || '';
  const timestamp = getTimestampMillis();

  const payload = {
    pid: data.pixelId,
    eid: createUuid(),
    ev: data.eventType,
    scroll: data.scrollDepth,
    time: data.timeOnPage,
    click: data.clickedId,
    conv_type: data.conversionType,
    conv_value: data.conversionValue,
    conv_meta: data.conversionMeta ? JSON.stringify(data.conversionMeta) : '',
    cid: userId,
    gid: gaId,
    url: getUrl(),
    ref: getReferrerUrl(),
    ts: timestamp
  };

  const pixelUrl = PIXEL_ENDPOINT + '?' + serialize(payload);

  sendPixel(pixelUrl, data.gtmOnSuccess, data.gtmOnFailure);
})();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "_insight_uid"
              },
              {
                "type": 1,
                "string": "_ga"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cs.ptbwa.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_insight_uid"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Conversion event is serialized and sent
  code: |-
    const mockUrl = [];
          mock('sendPixel', function(url, success, fail) {
            mockUrl.push(url);
            if (success) success();
          });
          mock('getCookieValues', () => ['uuid-abc']);
          mock('getUrl', () => 'https://example.com/thankyou');
          mock('getReferrerUrl', () => 'https://ad.com');
          mock('getTimestampMillis', () => 999999999);
          mock('generateRandom', () => 1);

          runCode({
            pixelId: 'abc123',
            eventType: 'purchase',
            conversionType: 'purchase',
            conversionValue: '49.99',
            conversionMeta: '{"coupon":"NEW50"}'
          });

          assertApi('sendPixel').wasCalled();
          assertApi('gtmOnSuccess').wasCalled();
          assertThat(mockUrl[0]).contains('conv_type=purchase');
          assertThat(mockUrl[0]).contains('conv_value=49.99');
          assertThat(mockUrl[0]).contains('conv_meta=%7B%22coupon%22%3A%22NEW50%22%7D');
- name: Cookie is set when not exists
  code: |-
    mock('getCookieValues', () => []);
          mock('setCookie', () => {});
          mock('sendPixel', (url, s, f) => s && s());
          mock('getUrl', () => 'https://test.com');
          mock('getReferrerUrl', () => '');
          mock('getTimestampMillis', () => 1234);
          mock('generateRandom', () => 1);

          runCode({
            pixelId: 'abc123',
            eventType: 'scroll',
            scrollDepth: '80'
          });

          assertApi('setCookie').wasCalled();
          assertApi('sendPixel').wasCalled();
          assertApi('gtmOnSuccess').wasCalled();
- name: gtmOnFailure is triggered on send error
  code: |-
    mock('sendPixel', function(url, success, fail) {
            if (fail) fail();
          });

          runCode({
            pixelId: 'fail123',
            eventType: 'click'
          });

          assertApi('gtmOnFailure').wasCalled();
setup: |2-
   const mockUrl = [];
        mock('sendPixel', function(url, success, fail) {
          mockUrl.push(url);
          if (success) success();
        });
        mock('getCookieValues', () => ['uuid-123']);
        mock('getUrl', () => 'https://example.com/page');
        mock('getReferrerUrl', () => 'https://referrer.com');
        mock('getTimestampMillis', () => 1234567890);
        mock('generateRandom', () => 1);

        runCode({
          pixelId: 'abc123',
          eventType: 'page_view'
        });

        assertApi('sendPixel').wasCalled();
        assertApi('gtmOnSuccess').wasCalled();
        assertThat(mockUrl[0]).contains('ev=page_view');
        assertThat(mockUrl[0]).contains('pid=abc123');


___NOTES___

Created on 2025. 11. 12. 오후 4:43:42


